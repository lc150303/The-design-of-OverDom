# 顶层策略【设计】

第一阶段计划实现：
* 重建
* 支援自己
* 开采过道
* 放弃过道
* 开采外矿
* 放弃外矿

## 子任务
:-:|:-:|:-:|:-:   
|触发条件||触发条件
claim|gcl提升 *or* unclaim完成|unclaim|战损统计*or*发现可转移的好房


### 1.claim 扩张  
影响因素
1. 房内情况
	1. anchor 到各点综合距离，越小越好
	2. 自动密铺的 extension 总距离，越小越好
	3. mineral 类型，是其他房间供给量比需求量越小的越好
	4. 防御所需 rampart 数量，次要因素，越小越好
2. 外围资源
	1. 范围内过道数量，越多越好，不计与已有房间重叠的
	2. 范围内外矿房数量，越多越好，不计已有重叠的，sk 房顶4个普通 source
3. 抽象条件
	1. 范围内过道房中有其他人挖的比例，越小越好
	2. 能否与最近的自己房间形成联合房间
	3. 与敌人或友军的距离
	4. 地图控制力（跨 shard 交通枢纽程度）

### 2.unclaim 退缩
影响因素
1. 上条 claim 中的最终打分
2. 战争压力
    1. 受攻打时间
    2. 受损情况
    3. 防御平均每 tick 消耗量
3. 帝国转移意图

### 3.rebuild 重建
由 Hive 发现房间损坏或错位时提交请求。

影响因素
1. 周边战争情况
    1. 有战争：有足够兵力保护则重建
    2. 无战争：同时重建的房间不超过2个，工厂和 lab 不在生产中

### 4.defense 支援自己
影响因素
1. 受攻击达到一定频率或强度
2. 战争资源充足
3. 与其他战争目标协调

### 5.defense-friend 支援友军

### 6.revenge 反击
对指定房间的进攻，包含多个强度。
影响因素
1. 受攻击达到一定频率或强度
2. 发现有效路径
3. 评估能打的下来
    1. 房内墙厚度
    2. 邻近敌方房间数量
    3. 自己的资源和空闲 pc

### 7.invade 侵略
对指定房间的进攻，包含多个强度。

### 8.highway 开采过道
扫一遍范围内的全开。

### 9.highway-unclaim 放弃过道
长期放弃，不同于短期节约 cpu。

影响因素
1. 路程
2. 受骚扰强度

### 10.outpost 开采外矿
影响因素
1. 空闲 cpu
2. 距离
3. 是否有其他人在挖
    1. 有则判断是否可攻击

### 11.outpost-unclaim 放弃外矿
长期放弃，不同于短期节约 cpu。

影响因素
1. 距离
2. 空闲 cpu 及是不是 sk 房
3. 受攻击强度
    1. 外矿受攻击强度
    2. Hive 受攻击强度
    

### 12.stronghold 攻打要塞
 
